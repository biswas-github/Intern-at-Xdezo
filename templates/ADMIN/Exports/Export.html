{% extends "base.html" %}
{% block extrastyles %}
{% endblock extrastyles %}
{% block extrajs %}
{% endblock extrajs %}
{% block content %}
    <!-- Page Header & Breadcrumbs -->
    <header class="">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="{% url 'AdminDashboard' %}">DataManagement</a>
                </li>
                <li class="breadcrumb-item">
                    <a href="#">Exports</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">Download Data</li>
            </ol>
        </nav>
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="page-title">Export Database Records</h1>
        </div>
    </header>
    <!-- Page Content Section -->
    <div class="page-section">
        <!-- ================= SECTION 1: EXPORT CONFIGURATION ================= -->
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Configure Export</h4>
                <hr>
                <!-- The Form -->
                <form method="post" action="">
                    <!-- Assuming you have a URL for this -->
                    {% csrf_token %}
                    <!-- 1. Date Range Filter -->
                    <div class="form-row mb-4">
                        <div class="col-md-6">
                            <label class="font-weight-bold text-muted small text-uppercase">From Date (Optional)</label>
                            <input type="date" class="form-control" name="start_date">
                            <small class="text-muted">Leave blank to export from the beginning.</small>
                        </div>
                        <div class="col-md-6">
                            <label class="font-weight-bold text-muted small text-uppercase">To Date (Optional)</label>
                            <input type="date" class="form-control" name="end_date">
                            <small class="text-muted">Leave blank to export up to today.</small>
                        </div>
                    </div>
                    <!-- 2. Data Selection (Checkboxes) -->
                    <div class="form-group">
                        <label class="font-weight-bold text-muted small text-uppercase d-block mb-3">
                            Select Data to Export <abbr title="Required">*</abbr>
                        </label>
                        <div class="row">
                            <!-- Column 1: Core Data -->
                            <div class="col-md-3">
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_students"
                                           name="models"
                                           value="STUDENTS">
                                    <label class="custom-control-label" for="exp_students">
                                        <i class="fas fa-user-graduate text-primary mr-2" style="width: 20px;"></i> Students
                                    </label>
                                </div>
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_instructors"
                                           name="models"
                                           value="INSTRUCTORS">
                                    <label class="custom-control-label" for="exp_instructors">
                                        <i class="fas fa-chalkboard-teacher text-info mr-2" style="width: 20px;"></i> Instructors
                                    </label>
                                </div>
                            </div>
                            <!-- Column 2: Academic -->
                            <div class="col-md-3">
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_courses"
                                           name="models"
                                           value="COURSES">
                                    <label class="custom-control-label" for="exp_courses">
                                        <i class="fas fa-book text-warning mr-2" style="width: 20px;"></i> Courses
                                    </label>
                                </div>
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_batches"
                                           name="models"
                                           value="BATCHES">
                                    <label class="custom-control-label" for="exp_batches">
                                        <i class="fas fa-layer-group text-purple mr-2" style="width: 20px;"></i> Batches
                                    </label>
                                </div>
                            </div>
                            <!-- Column 3: Logistics -->
                            <div class="col-md-3">
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_classrooms"
                                           name="models"
                                           value="CLASSROOMS">
                                    <label class="custom-control-label" for="exp_classrooms">
                                        <i class="fas fa-door-open text-secondary mr-2" style="width: 20px;"></i> Classrooms
                                    </label>
                                </div>
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_schedules"
                                           name="models"
                                           value="SCHEDULES">
                                    <label class="custom-control-label" for="exp_schedules">
                                        <i class="far fa-calendar-alt text-danger mr-2" style="width: 20px;"></i> Schedules
                                    </label>
                                </div>
                            </div>
                            <!-- Column 4: Records -->
                            <div class="col-md-3">
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_enrollments"
                                           name="models"
                                           value="ENROLLMENTS">
                                    <label class="custom-control-label" for="exp_enrollments">
                                        <i class="fas fa-id-card text-success mr-2" style="width: 20px;"></i> Enrollments
                                    </label>
                                </div>
                                <div class="custom-control custom-checkbox mb-3">
                                    <input type="checkbox"
                                           class="custom-control-input data-checkbox"
                                           id="exp_payments"
                                           name="models"
                                           value="PAYMENTS">
                                    <label class="custom-control-label" for="exp_payments">
                                        <i class="fas fa-money-bill-wave text-success mr-2" style="width: 20px;"></i> Payments
                                    </label>
                                </div>
                            </div>
                        </div>
                        <!-- Select All / None Link -->
                        <div class="mt-2">
                            <button type="button"
                                    class="btn btn-link btn-sm p-0"
                                    onclick="toggleAll(true)">Select All</button>
                            <span class="mx-1 text-muted">|</span>
                            <button type="button"
                                    class="btn btn-link btn-sm p-0"
                                    onclick="toggleAll(false)">Deselect All</button>
                        </div>
                    </div>
                    <hr class="my-4">
                    <!-- 3. Export Format & Action -->
                    <div class="d-flex flex-column flex-md-row justify-content-between align-items-center">
                        <div class="form-group mb-3 mb-md-0">
                            <label class="font-weight-bold text-muted small text-uppercase mr-2">File Format:</label>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio"
                                       id="fmt_csv"
                                       name="format"
                                       value="csv"
                                       class="custom-control-input"
                                       checked>
                                <label class="custom-control-label" for="fmt_csv">CSV (Excel Compatible)</label>
                            </div>
                        </div>
                        <a class="btn btn-sm btn-outline-primary px-5"
                           href="{% url 'download_report' %}">
                            <i class="fas fa-download mr-2"></i> Download Data</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock content %}
{% block bottomjs %}
    <script>
// --- 1. Select All / Deselect All Logic ---
function toggleAll(shouldSelect) {
    const checkboxes = document.querySelectorAll('.data-checkbox');
    checkboxes.forEach(cb => {
        cb.checked = shouldSelect;
    });
}
    </script>
{% endblock bottomjs %}
